(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/musicPage/info/index"],{"0a02":function(t,i,a){"use strict";a.r(i);var o=a("1026"),n=a.n(o);for(var e in o)"default"!==e&&function(t){a.d(i,t,function(){return o[t]})}(e);i["default"]=n.a},1026:function(t,i,a){"use strict";(function(t,o){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=e(a("a34a"));function e(t){return t&&t.__esModule?t:{default:t}}function u(t,i){return l(t)||r(t,i)||s()}function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function r(t,i){var a=[],o=!0,n=!1,e=void 0;try{for(var u,s=t[Symbol.iterator]();!(o=(u=s.next()).done);o=!0)if(a.push(u.value),i&&a.length===i)break}catch(r){n=!0,e=r}finally{try{o||null==s["return"]||s["return"]()}finally{if(n)throw e}}return a}function l(t){if(Array.isArray(t))return t}function c(t,i,a,o,n,e,u){try{var s=t[e](u),r=s.value}catch(l){return void a(l)}s.done?i(r):Promise.resolve(r).then(o,n)}function h(t){return function(){var i=this,a=arguments;return new Promise(function(o,n){var e=t.apply(i,a);function u(t){c(e,o,n,u,s,"next",t)}function s(t){c(e,o,n,u,s,"throw",t)}u(void 0)})}}var d="",f={components:{},data:function(){return{lyricsIndex:1,modalNameList:"",modalName:"",nowmiao:0,allmiao:1,lineBarWid:520,playState:0,audioCont:"",audioList:[],audioPlaySrc:0,audioWay:0}},computed:{width:function(){return"width:"+Math.floor(this.nowmiao)/this.allmiao*this.lineBarWid+"upx"},playWidth:function(){return"transform:translate3d("+Math.floor(this.nowmiao)/this.allmiao*this.lineBarWid+"upx,0,0);"},nowmiaoForc:function(){return this.$pubFuc.secondFormact(Math.floor(this.nowmiao))},allmiaoForc:function(){return this.$pubFuc.secondFormact(this.allmiao)},bgStyle:function(){return 0==this.audioList.length?"background-image:url(http://imge.kugou.com/stdmusic/20170720/20170720141006369299.jpg)":"background-image:url("+this.audioList[this.audioPlaySrc].picUrl+")"}},mounted:function(){var i=this;console.log(t("我进来音乐初始化页面了"," at pages\\musicPage\\info\\index.vue:138")),this.audioPlaySrc=0;var a=o.getStorageSync("musicList")||[];0==a.length||(this.tongbuKugouMusicUrl(!0),this.timer=setInterval(function(){i.tongbuKugouMusicUrl(!1),console.log(t("正在更新酷狗歌曲......"," at pages\\musicPage\\info\\index.vue:152"))},108e5));var n=this;o.$on("downloadPlay",function(t){n.fatherToPlay(t)})},methods:{tongbuKugouMusicUrl:function(){var i=h(n.default.mark(function i(a){var e,s,r,l,c,h,f,g,y,p,m,S,v,P,L;return n.default.wrap(function(i){while(1)switch(i.prev=i.next){case 0:for(e=o.getStorageSync("musicList")||[],s=[],r=[],l=0;l<e.length;l++)c=e[l],h=c[1],"1"==h.type&&(f=h.songOldUrl,s.push(l),r.push(f));if(!(r.length>0)){i.next=13;break}return i.next=7,o.request({url:this.$serverUrl+"/getMusicByMusic",data:JSON.stringify(r),method:"POST",header:{"content-type":"application/json"}});case 7:if(g=i.sent,y=u(g,2),p=y[0],m=y[1],p)console.log(t(p," at pages\\musicPage\\info\\index.vue:196"));else{for(console.log(t("刷新酷狗音乐歌曲id返回结果"+m.data," at pages\\musicPage\\info\\index.vue:198")),S=m.data,l=0;l<S.length;l++)h=S[l],v=h.songOldUrl,P=[v,h],L=s[l],e.splice(L,1,P);for(this.audioList=[],l=0;l<e.length;l++)c=e[l],this.audioList.push(c[1])}a&&(this.audioInit(),d.pause());case 13:case"end":return i.stop()}},i,this)}));function a(t){return i.apply(this,arguments)}return a}(),fatherToPlay:function(i){var a=i;console.log(t("我进来音乐初始化页面了_onload"," at pages\\musicPage\\info\\index.vue:233")),this.audioList=[];for(var n=o.getStorageSync("musicList")||[],e=a.songOldUrl,u=[e,a],s=0;s<n.length;s++){var r=n[s];if(r[0]!=u[0])this.audioList.push(r[1]);else{var l=r[1].type,c=r[1].type;"0"!=c&&"0"==l&&(u=r[0]),n.splice(s,1),s-=1}}n.unshift(u),this.audioList.unshift(a),o.setStorageSync("musicList",n),this.$forceUpdate(),console.log(t("yes"," at pages\\musicPage\\info\\index.vue:268")),this.audioPlaySrc=0,this.audioInit()},audioInit:function(){var i=this;if(d=o.getBackgroundAudioManager(),0!=this.audioList.length){var a=this.audioList[this.audioPlaySrc].songUrl,n=this.audioList[this.audioPlaySrc].authorName,e=this.audioList[this.audioPlaySrc].name,u=this.audioList[this.audioPlaySrc].picUrl;d.autoplay=!0,d.src=a,d.obeyMuteSwitch=!1,d.title=e,d.singer=n,d.coverImgUrl=u,this.$emit("changeSongMsg",this.audioList[this.audioPlaySrc]),d.autoplay=!0,d.onPlay(function(){i.playFunc(),i.allmiao=Math.floor(d.duration),i.$emit("changeState",i.playState)}),d.onPause(function(){i.pauseFunc(),i.$emit("changeState",i.playState)}),d.onTimeUpdate(function(a){i.nowmiao=d.currentTime;var n=Math.floor(100*i.nowmiao)/100;if(0!=i.audioList.length&&i.audioList[i.audioPlaySrc]){var e=i.audioList[i.audioPlaySrc].lyrics;if(e&&e.length>0){var u=1*e[e.length-1][0]-n;u>0&&(i.lyricsIndex=e.length);for(var s=0;s<e.length;s++){var r=e[s],l=1*r[0]-n;if(l>.3){console.log(t("come in"," at pages\\musicPage\\info\\index.vue:342")),i.lyricsIndex=s;break}}}if(i.nowmiao>60&&"true"==getApp().globalData.isShowPay){console.log(t("我进来了 onshow video"," at pages\\musicPage\\info\\index.vue:353"));var c=o.getStorageSync("userinfo");c.length||0==c.length?(d.pause(),o.showToast({title:"vip专享",duration:2e3})):c.vip?c.vip:(d.pause(),o.showToast({title:"vip专享",duration:2e3}))}}}),d.onEnded(function(){i.nextPlay()}),d.onError(function(a){console.log(t("播放错误"," at pages\\musicPage\\info\\index.vue:382")),0!=i.audioList.length&&o.showToast({icon:"none",title:"没有版权"})}),d.onNext(function(){i.nextPlay()}),d.onPrev(function(){i.upPlay()}),this.play();setTimeout(function(){i.play(),null},100)}},playFunc:function(){this.playState=1},pauseFunc:function(){this.playState=0},sliderChange:function(t){this.nowmiao=t.detail.value,d.seek(this.nowmiao)},play:function(){this.playState?d.pause():d.play()},nextPlay:function(){if(1==this.audioWay)this.audioPlaySrc=this.randomNum(0,this.audioList.length-1);else if(0==this.audioWay){if(this.audioPlaySrc==this.audioList.length-1)return void d.pause();this.audioPlaySrc>=this.audioList.length-1?this.audioPlaySrc=0:this.audioPlaySrc=this.audioPlaySrc+1}this.audioInit()},randomNum:function(t,i){switch(arguments.length){case 1:return parseInt(Math.random()*t+1,10);case 2:return parseInt(Math.random()*(i-t+1)+t,10);default:return 0}},upPlay:function(){if(0!=this.audioPlaySrc){if(1==this.audioWay)this.audioPlaySrc=Math.floor(10*Math.random())%this.audioList.length;else if(0==this.audioWay)if(this.audioPlaySrc<1)this.audioPlaySrc=this.audioList.length-1;else{if(this.audioPlaySrc==this.audioList.length)return;this.audioPlaySrc=this.audioPlaySrc-1}this.audioInit()}},audioWayFunc:function(){this.audioWay>1?this.audioWay=0:this.audioWay=this.audioWay+1},collectFunc:function(){this.collect=!this.collect},back:function(){this.$emit("fatherMethod")},showModal:function(t){this.modalNameList=t.currentTarget.dataset.target},hideModal:function(t){this.modalNameList=null},deleteMusic:function(t){var i=o.getStorageSync("musicList")||[];1!=i.length&&1!=this.audioList.length||(d.pause(),this.audioPlaySrc=0,this.allmiao=1,this.nowmiao=0,d.src="http:",this.$emit("changeSongMsg",[])),i.splice(t,1),o.setStorageSync("musicList",i),this.audioList.splice(t,1),this.audioPlaySrc==t&&this.audioPlaySrc+""!=""?this.audioInit():this.audioPlaySrc<t||this.audioPlaySrc>t&&(this.audioPlaySrc=this.audioPlaySrc-1)},deleteAll:function(){o.setStorageSync("musicList",[]),this.audioList=[],d.pause(),this.audioPlaySrc=0,this.allmiao=1,this.nowmiao=0,d.src="http:",this.$emit("changeSongMsg",[])},putToTop:function(t){if(0!=t){var i=o.getStorageSync("musicList")||[],a=i[t];i.splice(t,1),i.unshift(a),o.setStorageSync("musicList",i);var n=this.audioList[t];this.audioList.splice(t,1),this.audioList.unshift(n),this.audioPlaySrc<t?this.audioPlaySrc=this.audioPlaySrc+1:this.audioPlaySrc==t&&(this.audioPlaySrc=0)}},changeMusic:function(t){this.audioPlaySrc!=t?(this.audioPlaySrc=t,this.audioInit(),this.hideModal(t)):this.hideModal(t)}},destroyed:function(){d.destroy(),d=""}};i.default=f}).call(this,a("0de9")["default"],a("6e42")["default"])},"3d4b":function(t,i,a){"use strict";(function(t){a("e36c"),a("921b");o(a("66fd"));var i=o(a("4675"));function o(t){return t&&t.__esModule?t:{default:t}}t(i.default)}).call(this,a("6e42")["createPage"])},"408a":function(t,i,a){"use strict";var o,n=function(){var t=this,i=t.$createElement;t._self._c},e=[];a.d(i,"b",function(){return n}),a.d(i,"c",function(){return e}),a.d(i,"a",function(){return o})},4675:function(t,i,a){"use strict";a.r(i);var o=a("408a"),n=a("0a02");for(var e in n)"default"!==e&&function(t){a.d(i,t,function(){return n[t]})}(e);a("be77");var u,s=a("f0c5"),r=Object(s["a"])(n["default"],o["b"],o["c"],!1,null,"db33e97e",null,!1,o["a"],u);i["default"]=r.exports},be77:function(t,i,a){"use strict";var o=a("c850"),n=a.n(o);n.a},c850:function(t,i,a){}},[["3d4b","common/runtime","common/vendor"]]]);