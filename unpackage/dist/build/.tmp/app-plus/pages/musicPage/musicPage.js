(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/musicPage/musicPage"],{"0a02":function(t,e,i){"use strict";i.r(e);var a=i("1026"),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);e["default"]=n.a},1026:function(t,e,i){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(i("a34a"));function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){return c(t)||r(t,e)||u()}function u(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function r(t,e){var i=[],a=!0,n=!1,s=void 0;try{for(var o,u=t[Symbol.iterator]();!(a=(o=u.next()).done);a=!0)if(i.push(o.value),e&&i.length===e)break}catch(r){n=!0,s=r}finally{try{a||null==u["return"]||u["return"]()}finally{if(n)throw s}}return i}function c(t){if(Array.isArray(t))return t}function l(t,e,i,a,n,s,o){try{var u=t[s](o),r=u.value}catch(c){return void i(c)}u.done?e(r):Promise.resolve(r).then(a,n)}function h(t){return function(){var e=this,i=arguments;return new Promise(function(a,n){var s=t.apply(e,i);function o(t){l(s,a,n,o,u,"next",t)}function u(t){l(s,a,n,o,u,"throw",t)}o(void 0)})}}var d="",g={components:{},data:function(){return{lyricsIndex:1,modalNameList:"",modalName:"",nowmiao:0,allmiao:1,lineBarWid:520,playState:0,audioCont:"",audioList:[],audioPlaySrc:0,audioWay:0}},computed:{width:function(){return"width:"+Math.floor(this.nowmiao)/this.allmiao*this.lineBarWid+"upx"},playWidth:function(){return"transform:translate3d("+Math.floor(this.nowmiao)/this.allmiao*this.lineBarWid+"upx,0,0);"},nowmiaoForc:function(){return this.$pubFuc.secondFormact(Math.floor(this.nowmiao))},allmiaoForc:function(){return this.$pubFuc.secondFormact(this.allmiao)},bgStyle:function(){return 0==this.audioList.length?"background-image:url(http://imge.kugou.com/stdmusic/20170720/20170720141006369299.jpg)":"background-image:url("+this.audioList[this.audioPlaySrc].picUrl+")"}},mounted:function(){var e=this;console.log(t("我进来音乐初始化页面了"," at pages\\musicPage\\info\\index.vue:138")),this.audioPlaySrc=0;var i=a.getStorageSync("musicList")||[];0==i.length||(this.tongbuKugouMusicUrl(!0),this.timer=setInterval(function(){e.tongbuKugouMusicUrl(!1),console.log(t("正在更新酷狗歌曲......"," at pages\\musicPage\\info\\index.vue:152"))},108e5));var n=this;a.$on("downloadPlay",function(t){n.fatherToPlay(t)})},methods:{tongbuKugouMusicUrl:function(){var e=h(n.default.mark(function e(i){var s,u,r,c,l,h,g,f,p,m,v,y,P,S,w;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(s=a.getStorageSync("musicList")||[],u=[],r=[],c=0;c<s.length;c++)l=s[c],h=l[1],"1"==h.type&&(g=h.songOldUrl,u.push(c),r.push(g));if(!(r.length>0)){e.next=13;break}return e.next=7,a.request({url:this.$serverUrl+"/getMusicByMusic",data:JSON.stringify(r),method:"POST",header:{"content-type":"application/json"}});case 7:if(f=e.sent,p=o(f,2),m=p[0],v=p[1],m)console.log(t(m," at pages\\musicPage\\info\\index.vue:196"));else{for(console.log(t("刷新酷狗音乐歌曲id返回结果"+v.data," at pages\\musicPage\\info\\index.vue:198")),y=v.data,c=0;c<y.length;c++)h=y[c],P=h.songOldUrl,S=[P,h],w=u[c],s.splice(w,1,S);for(this.audioList=[],c=0;c<s.length;c++)l=s[c],this.audioList.push(l[1])}i&&(this.audioInit(),d.pause());case 13:case"end":return e.stop()}},e,this)}));function i(t){return e.apply(this,arguments)}return i}(),fatherToPlay:function(e){var i=e;console.log(t("我进来音乐初始化页面了_onload"," at pages\\musicPage\\info\\index.vue:233")),this.audioList=[];for(var n=a.getStorageSync("musicList")||[],s=i.songOldUrl,o=[s,i],u=0;u<n.length;u++){var r=n[u];if(r[0]!=o[0])this.audioList.push(r[1]);else{var c=r[1].type,l=r[1].type;"0"!=l&&"0"==c&&(o=r[0]),n.splice(u,1),u-=1}}n.unshift(o),this.audioList.unshift(i),a.setStorageSync("musicList",n),this.$forceUpdate(),console.log(t("yes"," at pages\\musicPage\\info\\index.vue:268")),this.audioPlaySrc=0,this.audioInit()},audioInit:function(){var e=this;if(d=a.getBackgroundAudioManager(),0!=this.audioList.length){var i=this.audioList[this.audioPlaySrc].songUrl,n=this.audioList[this.audioPlaySrc].authorName,s=this.audioList[this.audioPlaySrc].name,o=this.audioList[this.audioPlaySrc].picUrl;d.autoplay=!0,d.src=i,d.obeyMuteSwitch=!1,d.title=s,d.singer=n,d.coverImgUrl=o,this.$emit("changeSongMsg",this.audioList[this.audioPlaySrc]),d.autoplay=!0,d.onPlay(function(){e.playFunc(),e.allmiao=Math.floor(d.duration),e.$emit("changeState",e.playState)}),d.onPause(function(){e.pauseFunc(),e.$emit("changeState",e.playState)}),d.onTimeUpdate(function(i){e.nowmiao=d.currentTime;var n=Math.floor(100*e.nowmiao)/100;if(0!=e.audioList.length&&e.audioList[e.audioPlaySrc]){var s=e.audioList[e.audioPlaySrc].lyrics;if(s&&s.length>0){var o=1*s[s.length-1][0]-n;o>0&&(e.lyricsIndex=s.length);for(var u=0;u<s.length;u++){var r=s[u],c=1*r[0]-n;if(c>.3){console.log(t("come in"," at pages\\musicPage\\info\\index.vue:342")),e.lyricsIndex=u;break}}}if(e.nowmiao>60&&"true"==getApp().globalData.isShowPay){console.log(t("我进来了 onshow video"," at pages\\musicPage\\info\\index.vue:353"));var l=a.getStorageSync("userinfo");l.length||0==l.length?(d.pause(),a.showToast({title:"vip专享",duration:2e3})):l.vip?l.vip:(d.pause(),a.showToast({title:"vip专享",duration:2e3}))}}}),d.onEnded(function(){e.nextPlay()}),d.onError(function(i){console.log(t("播放错误"," at pages\\musicPage\\info\\index.vue:382")),0!=e.audioList.length&&a.showToast({icon:"none",title:"没有版权"})}),d.onNext(function(){e.nextPlay()}),d.onPrev(function(){e.upPlay()}),this.play();setTimeout(function(){e.play(),null},100)}},playFunc:function(){this.playState=1},pauseFunc:function(){this.playState=0},sliderChange:function(t){this.nowmiao=t.detail.value,d.seek(this.nowmiao)},play:function(){this.playState?d.pause():d.play()},nextPlay:function(){if(1==this.audioWay)this.audioPlaySrc=this.randomNum(0,this.audioList.length-1);else if(0==this.audioWay){if(this.audioPlaySrc==this.audioList.length-1)return void d.pause();this.audioPlaySrc>=this.audioList.length-1?this.audioPlaySrc=0:this.audioPlaySrc=this.audioPlaySrc+1}this.audioInit()},randomNum:function(t,e){switch(arguments.length){case 1:return parseInt(Math.random()*t+1,10);case 2:return parseInt(Math.random()*(e-t+1)+t,10);default:return 0}},upPlay:function(){if(0!=this.audioPlaySrc){if(1==this.audioWay)this.audioPlaySrc=Math.floor(10*Math.random())%this.audioList.length;else if(0==this.audioWay)if(this.audioPlaySrc<1)this.audioPlaySrc=this.audioList.length-1;else{if(this.audioPlaySrc==this.audioList.length)return;this.audioPlaySrc=this.audioPlaySrc-1}this.audioInit()}},audioWayFunc:function(){this.audioWay>1?this.audioWay=0:this.audioWay=this.audioWay+1},collectFunc:function(){this.collect=!this.collect},back:function(){this.$emit("fatherMethod")},showModal:function(t){this.modalNameList=t.currentTarget.dataset.target},hideModal:function(t){this.modalNameList=null},deleteMusic:function(t){var e=a.getStorageSync("musicList")||[];1!=e.length&&1!=this.audioList.length||(d.pause(),this.audioPlaySrc=0,this.allmiao=1,this.nowmiao=0,d.src="http:",this.$emit("changeSongMsg",[])),e.splice(t,1),a.setStorageSync("musicList",e),this.audioList.splice(t,1),this.audioPlaySrc==t&&this.audioPlaySrc+""!=""?this.audioInit():this.audioPlaySrc<t||this.audioPlaySrc>t&&(this.audioPlaySrc=this.audioPlaySrc-1)},deleteAll:function(){a.setStorageSync("musicList",[]),this.audioList=[],d.pause(),this.audioPlaySrc=0,this.allmiao=1,this.nowmiao=0,d.src="http:",this.$emit("changeSongMsg",[])},putToTop:function(t){if(0!=t){var e=a.getStorageSync("musicList")||[],i=e[t];e.splice(t,1),e.unshift(i),a.setStorageSync("musicList",e);var n=this.audioList[t];this.audioList.splice(t,1),this.audioList.unshift(n),this.audioPlaySrc<t?this.audioPlaySrc=this.audioPlaySrc+1:this.audioPlaySrc==t&&(this.audioPlaySrc=0)}},changeMusic:function(t){this.audioPlaySrc!=t?(this.audioPlaySrc=t,this.audioInit(),this.hideModal(t)):this.hideModal(t)}},destroyed:function(){d.destroy(),d=""}};e.default=g}).call(this,i("0de9")["default"],i("6e42")["default"])},"1e67":function(t,e,i){"use strict";i.r(e);var a=i("edb8"),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);e["default"]=n.a},"27ae":function(t,e,i){"use strict";var a=i("c36a"),n=i.n(a);n.a},"408a":function(t,e,i){"use strict";var a,n=function(){var t=this,e=t.$createElement;t._self._c},s=[];i.d(e,"b",function(){return n}),i.d(e,"c",function(){return s}),i.d(e,"a",function(){return a})},4675:function(t,e,i){"use strict";i.r(e);var a=i("408a"),n=i("0a02");for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);i("be77");var o,u=i("f0c5"),r=Object(u["a"])(n["default"],a["b"],a["c"],!1,null,"db33e97e",null,!1,a["a"],o);e["default"]=r.exports},"5df3":function(t,e,i){"use strict";var a,n=function(){var t=this,e=t.$createElement,i=(t._self._c,t.__map(t.list,function(e,i){var a=t.__map(e,function(e,i){var a=t.downLoadedMsg.indexOf(e.songOldUrl),n=t.downLoadedMsg.indexOf(e.songOldUrl);return{$orig:t.__get_orig(e),g0:a,g1:n}});return{$orig:t.__get_orig(e),l0:a}})),a=t.__map(t.hotList,function(e,i){var a=t.downLoadedMsg.indexOf(e.songOldUrl),n=t.downLoadedMsg.indexOf(e.songOldUrl);return{$orig:t.__get_orig(e),g2:a,g3:n}});t.$mp.data=Object.assign({},{$root:{l1:i,l2:a}})},s=[];i.d(e,"b",function(){return n}),i.d(e,"c",function(){return s}),i.d(e,"a",function(){return a})},be77:function(t,e,i){"use strict";var a=i("c850"),n=i.n(a);n.a},c36a:function(t,e,i){},c418:function(t,e,i){"use strict";(function(t){i("e36c"),i("921b");a(i("66fd"));var e=a(i("c8b1"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("6e42")["createPage"])},c850:function(t,e,i){},c8b1:function(t,e,i){"use strict";i.r(e);var a=i("5df3"),n=i("1e67");for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);i("27ae");var o,u=i("f0c5"),r=Object(u["a"])(n["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],o);e["default"]=r.exports},edb8:function(t,e,i){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(i("a34a")),s=o(i("4675"));function o(t){return t&&t.__esModule?t:{default:t}}function u(t,e){return l(t)||c(t,e)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function c(t,e){var i=[],a=!0,n=!1,s=void 0;try{for(var o,u=t[Symbol.iterator]();!(a=(o=u.next()).done);a=!0)if(i.push(o.value),e&&i.length===e)break}catch(r){n=!0,s=r}finally{try{a||null==u["return"]||u["return"]()}finally{if(n)throw s}}return i}function l(t){if(Array.isArray(t))return t}function h(t,e,i,a,n,s,o){try{var u=t[s](o),r=u.value}catch(c){return void i(c)}u.done?e(r):Promise.resolve(r).then(a,n)}function d(t){return function(){var e=this,i=arguments;return new Promise(function(a,n){var s=t.apply(e,i);function o(t){h(s,a,n,o,u,"next",t)}function u(t){h(s,a,n,o,u,"throw",t)}o(void 0)})}}var g=i("b33a"),f=function(){return i.e("components/navTab").then(i.bind(null,"1e93"))},p=function(){return i.e("components/tabBar4").then(i.bind(null,"60e7"))},m={components:{navTab:f,tabBar4:p,musicPlayer:s.default},data:function(){return{downLoadMsg:[],downLoadedMsg:[],isClickDownLoad:null,isClickPlay:null,showHot:null,name:"",authName:"",picUrl:"",playState:0,showMusicDetail:null,toView:"",currentPage:"musicPage",currentTab:0,pages:[1,1,1,1,1,1,1,1,1],paraForEachPage:[],input:"",inputOld:"",tabTitle:["推荐","","","",""],list:[],hotCateGory:[],hotList:[]}},onLoad:function(e){t.showLoading({title:"加载中"}),setTimeout(function(){t.hideLoading()},2e3),this.urlRequest(),this.getHot()},onShow:function(){},onHide:function(){},methods:{toTop:function(){var t=this;this.toView="",setTimeout(function(){t.toView="top"+t.currentTab},10)},showHotButton:function(t,e){var i=this;if(null!=e){var a=e.id;this.paraForEachPage[0].id=a,this.getMoreHost()}else{this.showHot=t,this.pages[0]="1",this.paraForEachPage[0].id="";setTimeout(function(){i.hotList=[],null},500)}},getMoreHost:function(){var e=d(n.default.mark(function e(){var i,s,o,r,c,l,h,d,g,f,p,m;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return i=this.paraForEachPage[0],s=this.input,o=i.id,r=this.pages[0],c="20",l={id:o,input:s,page:r,pageSize:c},e.next=8,t.request({url:this.$serverUrl+"/getMusicListByCategory",data:l,method:"POST",header:{"content-type":"application/json"}});case 8:h=e.sent,d=u(h,2),g=d[0],f=d[1],g?console.log(a(g," at pages\\musicPage\\musicPage.vue:283")):(this.pages[this.currentTab]++,p=f.data,m=this.hotList.concat(p),this.hotList=m,this.$forceUpdate(),this.showHot=!0);case 13:case"end":return e.stop()}},e,this)}));function i(){return e.apply(this,arguments)}return i}(),showMusicDetailFuc:function(){this.showMusicDetail=!0},fatherMethod:function(){this.showMusicDetail=null},clickParent:function(){this.playState=this.$refs.mychild.play()},changeState:function(t){this.playState=t},changeSongMsg:function(t){console.log(a("接收到子类的歌曲信息了"+t.name+t.authorName," at pages\\musicPage\\musicPage.vue:314")),this.name=t.name,this.authName=t.authorName,this.picUrl=t.picUrl},changeTab:function(t){this.currentTab=t},swiperTab:function(t){var e=t.detail.current;if(this.$refs.navTab.longClick(e),0!=this.input.length&&0!=this.currentTab){var i=this.list[this.currentTab];if(0==i.length||this.inputOld!=this.input&&""!=this.inputOld){this.inputOld=this.input;var n=this.paraForEachPage[this.currentTab],s=n.id,o=this.pages[this.currentTab],u="20",r={id:s,input:this.input,page:o,pageSize:u};console.log(a("para is "+n," at pages\\musicPage\\musicPage.vue:353")),this.urlRequestSerch(r)}}},lower1:g.throttle(function(e){if(0!=this.currentTab){console.log(a("加载".concat(this.currentTab)," at pages\\musicPage\\musicPage.vue:364")),t.showLoading({title:"加载中",mask:!0});var i=this.paraForEachPage[this.currentTab],n=this.input,s=i.id,o=this.pages[this.currentTab],u="20",r={id:s,input:n,page:o,pageSize:u};this.urlRequestNextPage(r)}},300),goUrl:function(t,e){this.isClickPlay=t,this.$refs.mychild.fatherToPlay(e)},urlRequest:function(){var e=d(n.default.mark(function e(){var i,s,o,r,c,l,h,d;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.request({url:this.$serverUrl+"/getMusicInit",method:"POST",header:{"content-type":"application/json"},timeout:"100000"});case 2:if(i=e.sent,s=u(i,2),o=s[0],r=s[1],o)console.log(a(o," at pages\\musicPage\\musicPage.vue:402"));else{for(c=r.data,this.paraForEachPage=c,this.tabTitle=[],this.pages=[],this.list=[],l=0;l<c.length;l++)h=c[l],this.tabTitle.push(h.showName),this.pages.push(h.page),this.list.push([]);console.log(a(c," at pages\\musicPage\\musicPage.vue:424")),d={id:"0",input:"",page:"1",pageSize:"20"},console.log(a("para is "+d," at pages\\musicPage\\musicPage.vue:433")),this.urlRequestSerch(d)}case 7:case"end":return e.stop()}},e,this)}));function i(){return e.apply(this,arguments)}return i}(),urlRequestNextPage:function(){var e=d(n.default.mark(function e(i){var s,o,r,c,l,h;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.request({url:this.$serverUrl+"/musicSearch",data:i,method:"POST",header:{"content-type":"application/json"},timeout:"100000"});case 2:if(s=e.sent,o=u(s,2),r=o[0],c=o[1],t.hideLoading(),!r){e.next=11;break}console.log(a(r," at pages\\musicPage\\musicPage.vue:453")),e.next=20;break;case 11:if(l=c.data,0!=l.length){e.next=15;break}return t.showToast({icon:"success",title:"没有更多了"}),e.abrupt("return");case 15:this.pages[this.currentTab]++,h=this.list[this.currentTab].concat(l),this.list[this.currentTab]=h,this.$forceUpdate(),console.log(a(l," at pages\\musicPage\\musicPage.vue:469"));case 20:case"end":return e.stop()}},e,this)}));function i(t){return e.apply(this,arguments)}return i}(),confirm:function(t){if(console.log(a("输入了"+t.detail.value," at pages\\musicPage\\musicPage.vue:474")),plus.key.hideSoftKeybord(),0!=t.detail.value.trim().length&&0!=this.currentTab){var e=this.paraForEachPage[this.currentTab],i=t.detail.value;if(this.input!=i){this.inputOld=this.input,this.input=i;for(var n=e.id,s=1;s<this.pages.length;s++)this.pages[s]=1,this.list[s]=[];this.pages[this.currentTab];var o=this.pages[this.currentTab],u="20",r={id:n,input:i,page:o,pageSize:u};console.log(a("para is "+e," at pages\\musicPage\\musicPage.vue:517")),this.urlRequestSerch(r)}}},urlRequestSerch:function(){var e=d(n.default.mark(function e(i){var s,o,r,c,l;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.showLoading({title:"加载中",mask:!0}),e.next=3,t.request({url:this.$serverUrl+"/musicSearch",data:i,method:"POST",header:{"content-type":"application/json"},timeout:"100000"});case 3:s=e.sent,o=u(s,2),r=o[0],c=o[1],t.hideLoading(),r?console.log(a(r," at pages\\musicPage\\musicPage.vue:539")):(l=c.data,this.list[this.currentTab]=l,this.$forceUpdate(),console.log(a(l," at pages\\musicPage\\musicPage.vue:545")));case 9:case"end":return e.stop()}},e,this)}));function i(t){return e.apply(this,arguments)}return i}(),playAll:function(e){var i=e;if(0!=i.length){for(var a=t.getStorageSync("musicList")||[],n=i.length-1;n>0;n--){for(var s=i[n],o=s.songOldUrl,u=[o,s],r=0;r<a.length;r++){var c=a[r];if(u[0]==c[0]){var l=c[1].type,h=u[1].type;"0"!=h&&"0"==l&&(u=muicCach1[0]),a.splice(r,1),r-=1;break}}a.unshift(u)}t.setStorageSync("musicList",a),this.goUrl("info/index",i[0])}else t.showToast({icon:"none",title:"播放列表不能为空"})},getHot:function(){var e=d(n.default.mark(function e(){var i,s,o,r,c;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.request({url:this.$serverUrl+"/getMusicCateGory",data:"",method:"POST",header:{"content-type":"application/json"}});case 2:i=e.sent,s=u(i,2),o=s[0],r=s[1],o?console.log(a(o," at pages\\musicPage\\musicPage.vue:607")):(c=r.data,this.hotCateGory=c,this.$forceUpdate(),console.log(a(c," at pages\\musicPage\\musicPage.vue:613")));case 7:case"end":return e.stop()}},e,this)}));function i(){return e.apply(this,arguments)}return i}(),downLoad:function(e,i){this.isClickDownLoad=i,console.log(a("进来下载页面了"," at pages\\musicPage\\musicPage.vue:620"));var n=t.downloadFile({url:e.songUrl,success:function(i){console.log(a("下载到临时文件夹成功",i," at pages\\musicPage\\musicPage.vue:625")),t.saveFile({tempFilePath:i.tempFilePath,success:function(i){var n=i.savedFilePath;console.log(a("保存文件情况",i," at pages\\musicPage\\musicPage.vue:632"));var s=t.getStorageSync("saveMusic")||[];e.songUrl=n,e.type="0",s.push(e),t.setStorageSync("saveMusic",s)},fail:function(t){console.log(a("保存失败",t," at pages\\musicPage\\musicPage.vue:647")),isDowned=!0}})},fail:function(t){console.log(a("下载到临时文件夹失败",t," at pages\\musicPage\\musicPage.vue:653"))}});console.log(a("我已经把下载进度保存下来了"," at pages\\musicPage\\musicPage.vue:657"));var s={songOldUrl:e.songOldUrl,taskPersent:"0",isCansole:"false"};this.downLoadMsg.push(s),-1===this.downLoadedMsg.indexOf(e.songOldUrl)&&(this.downLoadedMsg=this.downLoadedMsg+e.songOldUrl),this.$forceUpdate();var o="1",u=this;n.onProgressUpdate(function(t){var i=t.progress;if(o!=i){o=i;for(var n=u.downLoadMsg,s=0;s<n.length;s++){var r=n[s];if(r.songOldUrl==e.songOldUrl){r.taskPersent=i,n=n.splice(s,1,r),u.downLoadMsg=n,u.$forceUpdate(),console.log(a(i," at pages\\musicPage\\musicPage.vue:699"));break}}}})}}};e.default=m}).call(this,i("6e42")["default"],i("0de9")["default"])}},[["c418","common/runtime","common/vendor"]]]);